---
layout: post
title: 2 - 도메인 지식 찾아내기
tags: [DDD, Domain-Driven-Develop]
date: 2025-08-05 10:00:00 +0900
---

> 운영환경에 배포되는 것은 도메인 전문가의 지식이 아니라 개발자의 이해 혹은 오해다 - 알베르토 브랜돌리니
> 

## 비즈니스 문제

- 우리가 개발하는 소프트웨어 → 비즈니스 문제의 솔루션
    - 여기서 문제는 수학 문제나 수수께끼 X
    - 비즈니스 도메인의 컨텍스트에서 문제의 의미는 광범위
        - 워크플로우와 프로세스 최적화
        - 수작업 최적화
        - 자원 관리
        - 의사결정 지원
        - 데이터 관리 등
- 비즈니스 문제는 비즈니스 도메인과 하위 도메인의 모든 수준에서 발생할 수 있다
    - 기업의 목표는 고객의 문제를 해결하는 솔루션을 제공하는 것
    - 하위 도메인 → 세분화된 문제 도메인, 비즈니스 기능에 대한 솔루션을 제공하는 것이 목적
        - 지식 관리 하위 도메인 → 정보를 저장 및 추출하는 프로세스
        - 어음 교환 하위 도메인 → 재무 거래 실행 프로세스 최적화 솔루션
        - 회계 하위 도메인 → 기업의 자금을 관리하는 솔루션

## 도메인 지식 찾아내기

- 효과적인 소프트웨어 솔루션을 설계한다면 적어도 기본적인 비즈니스 도메인 지식이 있어야 함
    - 허나 이건 도메인 전문가의 몫, 우리는 될 필요도 없고, 될 수도 없음 → 비즈니스 용어만이라도 이해해보자
- 효과적인 소프트웨어는 도메인 전문가가 문제를 생각하는 방식 → **멘탈 모델**을 모방해야함
    - 비즈니스 문제와 요구사항 이면에 있는 “이유에 대한 이해”가 없다면 그냥 소스코드로 요구사항을 번역한 것에 불과함
        
        → 만약 여기서 중요한 ‘극단적인 경우’를 놓친다면? or 비즈니스 개념을 설명하지 못해 미래의 요구사항을 충족할 모델을 구현할 역량이 제한된다면? 
        
- 알베르토 브랜돌리니는 소프트웨어 개발은 배우는 과정, 작동하는 코드는 그 부산물
    - 소프트웨어 프로젝트의 성공은 도메인 전문가와 개발자간의 효과적인 지식공유에 달렸다
- 지식공유를 위한 효과적인 **커뮤니케이션이** 필요하다

## 커뮤니케이션

- 거의 모든 소프트웨어 프로젝트는 다양한 역할의 이해관계자의 협업이 필요
    - 결과는 이 모든 참가자들이 얼마나 잘 협력할 수 있냐에 달려있다
        - 해결하려는 문제에 대하여 모든 이해관계자가 동의하고 있는가?
        - 개발하고 있는 솔루션의 기능 또는 비기능 요구사항 중에 서로 충돌하는 가정이 있지 않은가?
        
        → 프로젝트와 연관된 모든 것에 대한 합의와 일치는 프로젝트의 성공에 필수다
        
- 프로젝트가 실패하는 이유에 대한 연구에서 효과적인 커뮤니케이션이 지식 공유와 프로젝트 성공에 필수라는 것을 밝혀냄
    - 이렇게 중요하지만 실제로 목격하기에는 어렵다
    - 일반적인 지식 공유 흐름
        
        ![2-1](/assets/images/ddd/2-1.png)
        
- 전형적인 소프트웨어 개발 생애주기에서 도메인 지식은 **분석 모델**로 알려진 엔지니어 친화적인 형태로 변환됨
    - 예시를 들어보자면, 결론적으로 도메인 개발자에게 들은 요구 사항에 대해서 개발을 진행해야 하고, 이 개발은 개발자들끼리 진행하기에, 자신들이 사용할 때 편한 단어와 워드로 표현을 진행
    
    → 많은 양의 정보가 사라지고 손실되면서, 추후에는 최신 정보까지 담아내지 못하는 문제가 발생
    
    - 도메인 지식을 코드로 구현하는 데 필요한 다양한 변환을 보여준다
    
    ![2-2](/assets/images/ddd/2-2.png)
    
    - 이런 정보는 개발자가 잘못된 솔루션을 구현하게 하거나 솔루션이 올바르다 해도 해결하려는 문제가 잘못된 경우로 이어짐 → 프로젝트 실패

## 유비쿼터스 언어란 무엇인가?

- 유비쿼터스 언어의 사용은 도메인 주도 설계의 초석
    - 참가자들이 효과적으로 소통하기 위해 변환에 의존하지 말고 같은 언어를 사용하는 것

> 우리가 말하는 상식은 실제로 일반적이지 않다 - 볼테르
> 

- 전통적인 소프트웨어 개발 생애주기에서 변환이 어떻게 일어나는지 정리
    - 도메인 지식 → 분석 모델
    - 분석 모델 → 요구사항
    - 요구사항 → 시스템 설계
    - 시스템 설계 → 소스코드
- 도메인 지식을 계속해서 변환하는 대신 비즈니스 도메인을 설명하기 위한 단일화된 언어 체계 → 유비쿼터스
- 개발자, 제품 소유자, 도메인 전문가, UI/UX 디자이너와 같은 프로젝트 이해관계자는 유비쿼터스 언어를 사용
    - 이 언어를 사용함으로써 비즈니스 도메인을 추론하는데 **편안함을 느껴야** 한다는 점이 중요

## 비즈니스 언어

- 비즈니스 언어이기에, 기술 용어는 빼고 비즈니스 도메인에 관련된 용어로만 구성
    - 도메인 전문가의 이해와 비즈니스 도메인에 대한 **멘탈 모델을 쉽게 이해**할 수 있는 관점으로 표현하는 것을 목표로 함

### 시나리오

- 다음과 같은 문장들을 읽어보자
    - 광고 캠페인은 다양한 창의적인 자료를 전시할 수 있다.
    - 캠페인은 최소한 하나의 광고 할당이 활성화되어야 게시된다.
    - 판매 커미션은 거래가 승인된 후에 회계 처리된다.
- 유비쿼터스 언어가 아닌 문장
    - 광고의 아이프레임(iframe)은 HTML 파일을 표시한다.
    - 캠페인은 ‘활성-할당(active-placement)’ 테이블에 하나의 연관 레코드가 있어야 게시된다.
    - 판매 커미션은 거래(transaction) 테이블과 판매-승인(approved-sales) 테이블의 연관 레코드에 근거하여 처리된다.
- 도메인 전문가도 문장을 읽기 어렵고, 개발자도 요구사항을 이해하지 못해 개판될 가능성 UP!

### 일관성

- 유비쿼터스 언어는 반드시 정확하고 일관성 있어야 함
- 가정할 필요가 없어야 하고 비즈니스 도메인의 로직을 명료하게 표현해야 한다.
- 모호성이 커뮤니케이션을 방해하기 때문에 언어의 용어는 오직 하나의 의미를 가져야 한다.
    - 불분명한 용어의 몇 가지 예와 개선 방법을 살펴보자

### 모호한 용어

- 어던 비즈니스 도메인에서는 **정책(Policy)** 이라는 용어가 규제, 규칙 또는 보험 계약과 같은 여러 의미를 내포
    - 정확한 의미는 맥락에 따라 사람 간의 상호작용을 통해서만 알 수 있다
    - 허나 소프트웨어는 모호성에 잘 대처하지 못하며, “정책” 이라는 개체를 코드로 모델링하기가 어려울 수 있음
- 유비쿼터스 언어는 용어마다 단일 의미를 갖게 하기 때문에 “정책”의 경우 ‘**규제 규칙(regulartory rule)’ ‘보험 계약(insurance contract)’**의 두 용어를 사용하여 명확한 모델을 만들어야 함

### 동의어

- 유비쿼터스 언어에서 두 용어는 서로 바꿔 사용할 수 없다.
    - 사용자는 다양한 곳에서 사용하지만, 도메인 전문가에게는 사용자, 방문자, 관리자, 계정 등의 다른 용어가 혼용된다는 것을 발견할 수 있음
    - 당연히 처음에는 괜찮지만 개념이 많이 쌓이는 순간 잘못된 이해가 생기기 시작한다

## 비즈니스 도메인 모델

### 모델이란 무엇인가?

> 모델이란 사물이나 현상에서 의도한 관점만 강조하고 다른 측면은 무시하여 간략히 표현한 것이다. 즉, 특정 용도를 마음에 둔 추상화의 결과다 - 레베카 워프스-브룩
> 

- 모델은 실셰계의 복제가 아니라 우리가 실제 시스템을 이해하는 데 도움을 주는 인간의 창조물
    - 잘 설명하는 예시로는 지도
        
        ![2-3](/assets/images/ddd/2-3.png)
        
    - 새부적인 모든 것을 나태내지 않고, 특정 목적을 지원하는 데 충분한 자료만 담고 있음 → 특정 목적이 지도가 풀고자 하는 문제

### 효과적인 모델링

- 모든 모델에는 목적이 있고 효과적인 모델은 그 목적을 달성하는 데 필요한 세부사항만 포함한다
    - 세계지도 → 지하철 정거장 정보 X
    - 지하철 노선도 → 거리 측정 X
    
    → 각 지도는 제공해야 할 정보만 포함
    
- 유용한 모델은 실세계의 복사본이 아니라 문제를 해결하려는 의도가 있으며 그 목적에 필요한 정보만 제공해야 함

> 모든 모델은 문제가 있지만, 일부는 유용하다 - 조지 박스
> 

- 모델은 본질적으로 추상화의 결과
    - 불필요한 상세 정보 생략하여 복잡한 문제 다룰수 있도록, 문제에 필요한 정보만 남김
    - 그렇지 않다면 필요한 정보를 날리거나, 잡음을 유발함
        
        → 추상화의 목적은 모호함이 아니라 절대적으로 정확할 수 있는 새로운 의미론적 수준을 만드는 것
        

### 비즈니스 도메인 모델링

- 유비쿼터스 언어를 발전시키는 것은 사실상 비즈니스 도메인 모델을 구축하는 셈
- 모델은 비즈니스가 기능을 어떻게 구현하느냐에 대한 도메인 전문가의 사고 프로세스인 멘탈 모델을 포착해야함
    - 모델은 관련된 비즈니스 엔티티와 그것의 행동, 인과 관계, 불변성 등을 반영해야 한다.
- 유비쿼터스 언어는 모든 가능한 상세 정보를 포함하는 것이 아닌, 소프트웨어가 해결하고자 하는 특정 문제를 해결하는 데 필요한 만큼의 비즈니스 도메인 관점을 포함하면ㄷ ㅚㅁ
- 엔지니어링 팀과 도메인 전문가의 효과적인 커뮤니케이션은 필수
    - 비즈니스 도메인이 복잡할 수록 커뮤니케이션의 중요성 커짐
    - 복잡할 수록 모델링하고 코드로 구현하기 어려움
    - 이해했는지 확인할 신뢰성 있는 유일한 방법은 도메인 전문가가 이해할 수 있는 언어로 대화하는 것

### 지속적인 노력

- 유비쿼터스 언어를 정형화하려면 도메인 전문가와의 상호작용이 필요
    - 상호작용만이 비즈니스 도메인에 대한 잘못된 가정, 부정확함, 전체적인 이해 오류를 발견할 수 있음
- 모든 이해관계자는 모든 프로젝트와 관련된 커뮤니케이션에 유비쿼터스 언어를 지속적으로 사용해서 지식 공유를 확산하고 비즈니스 도메인에 대한 공유된 이해를 강화해야함
    - 요구사항
    - 테스트
    - 문서화
    - 소스코드 자체에서 유비쿼터스 언어 사용
- 지속해서 검증하고 발전ㄴ시켜야 함
- 그러다보면 비즈니스 도메인에 대한 통찰을 얻을 것이다
    - 이 때 또 다시 유비쿼터스 언어 또한 발전해야 함

### 도구

- 유비쿼터스 언어를 수집하고 관리하는 과정을 돕는 도구와 기술
    - 위키 → 용어집 : 비즈니스 도메인의 용어에 대한 정보를 얻을 수 있는 거점 역할
        - 새로운 팀원이 쉽게 적응하게 해줌
        - 뿐만 아니라 다 함께 유지보수하는 것이 중요함
        - 모든 팀원이 수정할 수 있게 독려해야함
- 명사가 중요하긴 하지만 행동을 포착하는 것이 중요
    - 행동은 단순히 명사와 관련된 동사의 목록이 아닌 규칙, 가정, 그리고 불변성을 가진 실제 비즈니스 로직 → 문서화하기 훨씬 어려움
    - 그러므로 용어집은 유스케이스 또는 거킨 테스트처럼 행동을 포착하는데 적합한 다른 도구와 함계 사용하는 것이 가장 좋다
- 거킨 언어로 작성된 자동화 테스트는 유비쿼터스 언어를 포착하기에 좋은 언어일 뿐 아니라 도메인 전문가와 개발자의 간극을 메우는 보조 도구 역할 할 수 있음
    
    ![2-4](/assets/images/ddd/2-4.png)
    

### 도전과제

- 유비쿼터스 언어를 발전시키는 거 보기보다 어렵다
    - 대부분의 가장 중요한 지식은 도메인 전문가의 암묵지 → 질문하는 방법밖에는 알 수 있는 방법이 없음
    - 이 기법에 경험이 쌓이면 단순히 존재하는 지식을 발견하는 것 뿐만 아니라 도메인 전문가와 협력해서 모델을 함계 만들어가는 것이 자주 포함된다는 사실을 알게됨
    - 질문을 통해서 종종 숨어있던 충돌과 공백을 찾아내 명확하게 할 수 있음