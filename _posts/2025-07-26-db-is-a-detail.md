---
layout: post
title: 30장 - 데이터베이스는 세부사항이다
tags: [clean-architecture]
date: 2025-07-30 10:00:01 +0900
---

- 아키텍쳐 관점에서 볼 때 DB는 엔티티가 아님 → 세부사항이기에 구성요소 수준으로 끌어올릴 수 없다.
    - SW 시스템의 아키텍처와 DB의 관계를 건물로 비교하면 건물의 아키텍쳐 VS 문 손잡이
    - 데이터의 구조는 아키텍쳐에서 대단히 중요, 하지만 DB는 데이터 모델이 아님

### 관계형 데이터베이스

- 에드거 커드는 1970년에 관계형 DB의 원칙을 정의함
    - 우아하고, 절제되었으며 강건했어서 인기를 끌었음
- 그래도 DB는 세부사항이다
    - 테이블에 행 단위로 데이터를 배치한다는 게 아키텍쳐에서는 아무 의미없음, 중요하지도 않음
    - 많은 데이터 접근 프레임워크가 테이블과 행이 객체 형태로 시스템 여기저기 돌아다니게 허용하는 데 → 잘못된 설계

### 데이터베이스 시스템은 왜 이렇게 널리 사용되는가?

- 어떻게 데이터베이스 시스템이 소프트웨어 시스템과 소프트웨어 기업을 장악할 수 있었을까?
    - 오라클, MySQL, SOL. 서버가 우위를 차지할 수 있던 이유는 무엇일까?
    
    → '디스크' 
    
- 디스크가 너무 오래 걸려서 시간 지연을 완화하기 위해서 색인, 캐시, 쿼리 계획 최적화 등이 필요해짐
    - 뿐만 아니라 일종의 표준적인 표현방식도 필요했음
    - 이걸 관리하는 시스템이 필요해졌고 시간이 지나 파일시스템과 RDBMS로 나뉘어짐
- 파일 시스템은 문서 기반
    - 문서 전체를 자연스럽고 편리하게 저장하는 방법을 제공
    - 문서를 이름을 기준으로 저장할때는 잘 동작, 내용을 기준으로는 X
- DBMS는 내용기반
    - 내용을 기반으로 레코드를 자연스럽고 편리하게 찾는 방법 제공
    - 일부 내용에 기반해서 다수의 레코드를 연관 짓는데 매우 탁월, 정형화되지 않은 문서를 저장하고 검색하는데는 X

### 디스크가 없다면 어떻게 될까?

- 무수히 많은 데이터 구조로 체계화
- 데이터에 접근할 때는 포인터나 참조를 사용
    - 이미 이렇게 일하고 있음

### 세부사항

- DB가 세부사항이라고 말하는 이유는 이러한 현실 때문
    - 그저 매커니즘에 불과함
    - 디스크와 RAM 사이에서 데이터를 옮길때 사용할 뿐

### 하지만 성능은?

- 데이터 저장소의 측면에서 성능은 완전히 캡슐화하여 업무 규칙과는 분리할 수 있는 관심사
    - 데이터를 빠르게 넣고 뺄 수 있어야 한다는 건 저수준의 관심사
- 성능은 시스템의 전반적인 아키텍처와는 아무런 관련이 없다

### 개인적인 일화

- 1980년대 후반, 한 스타트업에서 엔지니어 팀을 이끌던 나는, 간단한 랜덤 액세스 파일 시스템을 사용해 효율적인 데이터를 처리하고 있었다.
- 마케팅 담당자와 외부 하드웨어 엔지니어는 **RDBMS 도입을 주장**했고, 나는 기술적·공학적으로 그 필요성을 납득하지 못해 **강하게 반대**했다.
- 끝내 그들은 경영진의 지지를 얻어 RDBMS를 도입했고, 나는 밀려났다. 기술적 이유가 아닌 **마케팅적/정서적 이유**로 결정된 것이었음을 뒤늦게 깨달았다.
- 고객은 RDBMS가 필요해서가 아니라 **“신뢰성과 안정성”을 마케팅적으로 보장받고 싶어 했고**, 현실에서는 공학적 논리가 통하지 않을 수 있다는 사실을 체감했다.
- 다시 그때로 돌아간다면 RDBMS와 기존 구조의 **균형점을 찾는 설계 방식**을 택했을 것이며, 결국 나는 기술뿐 아니라 비즈니스를 이해하는 **컨설턴트**가 되었다.

> “현실 세계에서는 기술적 정당성보다 시장, 고객의 인식, 마케팅이 더 큰 힘을 가질 수 있다. 기술자는 현실과 이상 사이의 균형 감각을 가져야 한다.”
>